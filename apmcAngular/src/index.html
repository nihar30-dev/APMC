<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>APMC</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <!-- <script src="https://apis.google.com/js/api.js"></script> -->
  <!-- <script src="https://apis.google.com/js/platform.js" async defer></script> -->
  <!-- <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script> -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script>

    function handleCredentialResponse(response) {

      $.ajax({
        url: "http://localhost:8099/api/auth/google",
        headers: {
          "idToken" : response.credential
        },
        method : 'POST'
      })
              .then((res) => {

                localStorage.setItem('isLoggedin', 'true');
                localStorage.setItem('auth-user',JSON.stringify(res));


                // window.location.href = "http://localhost:4200/home";

              })
              .catch(err => {
              })

      console.log("Encoded JWT ID token: " + response.credential);
      //   Split the token into header, payload, and signature
      const parts = response.credential.split('.');
      const header = parts[0];
      const payload = parts[1];
      const signature = parts[2];

      //   Decode the payload from base64
      const decodedPayload = atob(payload);

      //   Parse the decoded payload as JSON
      const jsonPayload = JSON.parse(decodedPayload);
      console.log(jsonPayload);


    }
  </script>

</head>
<body>
  <app-root></app-root>
</body>
</html>
