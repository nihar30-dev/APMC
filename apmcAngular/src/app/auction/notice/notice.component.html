<button *ngIf="role==='ADMIN'" style="background-color: #325c32; color: white;" (click)="open(content)" class="btn btn-outline-primary btn-sm shopBtn">
  <h6>Add Notice</h6>
</button>



<app-loader-mask *ngIf="(loaderService.getLoaderVisibility() | async) && notifications===null"></app-loader-mask>

<ng-template #content let-modal>
  <div class="modal-header" style="background-color: #325c32; color: white;">
    <h4 class="modal-title" id="modal-basic-title">Add New Notice</h4>
    <a type="button" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <i class="bi bi-x" style="font-size: xx-large;"></i>
    </a>
  </div>
  <div class="form-container modal-body">
    <form [formGroup]="noticeForm" #nf="ngForm" (ngSubmit)="onSubmit(noticeForm)" novalidate>

      <div class="form-group">
        <label for="heading">Heading:</label>
        <input type="text" id="heading" formControlName="heading" class="form-control" required />
        <div *ngIf="noticeForm.controls['heading']?.invalid && noticeForm.controls['heading']?.['touched']"
             class="alert alert-danger">
          Heading is required.
        </div>
      </div>
      <div class="form-group">
        <label for="details">Details:</label>
        <textarea id="details" formControlName="details" class="form-control" required></textarea>
        <div *ngIf="noticeForm.get('details')?.['invalid'] && noticeForm.get('details')?.['touched']"
             class="alert alert-danger">
          Details are required.
        </div>
      </div>
      <div class="form-group">
        <label >Starting date for notice: </label>
        <div class="d-flex justify-content-around">
          <input class="form-control" formControlName="startDate" name="d2" ngbDatepicker #d2="ngbDatepicker" placeholder="dd/MM/yyyy"/>
          <button class="btn btn-outline-secondary bi bi-calendar3" (click)="d2.toggle()" type="button"></button>
        </div>

      </div>
      <div class="form-group">
        <label >Expiration date for notice:</label>
        <div class="d-flex justify-content-around">
          <input class="form-control" formControlName="endDate" placeholder="dd/MM/yyyy" name="d3" ngbDatepicker #d3="ngbDatepicker" />
          <button class="btn btn-outline-secondary bi bi-calendar3" (click)="d3.toggle()" type="button"></button>
        </div>
      </div>


    </form>
  </div>
  <div class="modal-footer">
    <button type="reset" class="btn btn-secondary" style="background-color: #325c32; color: white;" (click)="noticeForm.reset()" >Reset</button>
    <button type="submit" class="btn btn-outline-dark"  style="background-color: #325c32; color: white;" [disabled]="!noticeForm.controls['heading'].valid || !noticeForm.controls['details'].valid" (click)="nf.ngSubmit.emit()">Save</button>
  </div>
</ng-template>


<div class="accordian" (scroll)="onScroll($event)">

  <ngb-accordion [closeOthers]="true" *ngFor="let notice of notifications">
    <ngb-panel id="{{ notice.noticeId }}">
      <ng-template ngbPanelTitle>
        <div class="d-flex justify-content-between align-items-center w-100">
          <p class="mt-3">{{ notice.noticeHeading }}</p>
          <div class="text-right">
            <p class="m-0">{{notice.createdAt |  date: 'dd/MM/yyyy'}}</p>
          </div>
        </div>
      </ng-template>
      <ng-template ngbPanelContent>
        {{ notice.noticeContent }}
      </ng-template>
    </ngb-panel>
  </ngb-accordion>
  <div class="d-flex justify-content-around">
    <app-loader-mask *ngIf="(loaderService.getLoaderVisibility() | async)"></app-loader-mask>
  </div>
</div>

